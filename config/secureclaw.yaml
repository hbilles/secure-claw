# SecureClaw Configuration
# Phase 6: Multi-provider LLM support

# LLM provider configuration.
# Supported providers: anthropic, openai, lmstudio
#
# Anthropic (default):
#   provider: anthropic
#   model: claude-sonnet-4-20250514
#   Requires ANTHROPIC_API_KEY env var.
#
# OpenAI:
#   provider: openai
#   model: gpt-4o
#   Requires OPENAI_API_KEY env var.
#   Optional: baseURL for Azure OpenAI or other compatible endpoints.
#
# LM Studio (local):
#   provider: lmstudio
#   model: qwen3-235b-a22b        # Must match model loaded in LM Studio
#   No API key needed.
#   Default baseURL: http://host.docker.internal:1234/v1
#   (host.docker.internal resolves to the host machine from inside Docker)

llm:
  provider: anthropic
  model: claude-sonnet-4-6
  maxTokens: 4096

executors:
  shell:
    image: secureclaw-executor-shell
    memoryLimit: 512m
    cpuLimit: 1
    defaultTimeout: 60
    defaultMaxOutput: 1048576  # 1MB

  file:
    image: secureclaw-executor-file
    memoryLimit: 256m
    cpuLimit: 0.5
    defaultTimeout: 30
    defaultMaxOutput: 5242880  # 5MB

  web:
    image: secureclaw-executor-web
    memoryLimit: 1g
    cpuLimit: 2
    defaultTimeout: 120
    defaultMaxOutput: 2097152  # 2MB
    # Domains the web executor is allowed to access (HTTPS only).
    # All other domains are blocked at the DNS level.
    allowedDomains:
      - news.ycombinator.com
      - github.com
      - docs.anthropic.com
      - docs.google.com
      - stackoverflow.com
      - en.wikipedia.org
      - developer.mozilla.org
      - npmjs.com
      - pypi.org

# Mount policies: what host directories are accessible, and how.
# hostPath uses the Docker host's filesystem (~ is resolved at runtime).
# containerPath is the path inside executor containers.
mounts:
  - name: projects
    hostPath: ~/projects
    containerPath: /workspace
    readOnly: false

  - name: documents
    hostPath: ~/Documents
    containerPath: /documents
    readOnly: true

  - name: sandbox
    hostPath: ~/secureclaw-sandbox
    containerPath: /sandbox
    readOnly: false

# Action tiers — HITL approval gates.
# Classification is code-only; the LLM never sees these tiers.
# Rules are checked in order: autoApprove → notify → requireApproval.
# If no rule matches, the default is requireApproval (fail-safe).
#
# Condition keys MUST match the tool input field names exactly
# (e.g., 'path', 'working_directory', 'command').
actionTiers:
  autoApprove:
    - tool: read_file
    - tool: list_directory
    - tool: search_files
    - tool: run_shell_command
      conditions:
        working_directory: /sandbox/**
    # Phase 5: Read-only service tools
    - tool: search_email
    - tool: read_email
    - tool: list_events
    - tool: search_repos
    - tool: list_issues
    - tool: read_file_github

  notify:
    - tool: write_file
      conditions:
        path: /sandbox/**
    # Phase 5: Browse trusted domains (notify instead of require-approval)
    # browse_web on untrusted domains falls through to require-approval

  requireApproval:
    - tool: write_file
      conditions:
        path: "!(/sandbox/**)"    # Anywhere outside sandbox
    - tool: run_shell_command
      conditions:
        working_directory: "!(/sandbox/**)"
    # Phase 5: All outgoing actions always require approval
    - tool: send_email
    - tool: reply_email
    - tool: create_event
    - tool: update_event
    - tool: create_issue
    - tool: create_pr
    # Phase 5: Web browsing (default tier — all browse_web calls)
    - tool: browse_web

# Domains trusted for web browsing.
# browse_web calls to these domains use the "notify" tier instead of "require-approval".
trustedDomains:
  - github.com
  - docs.anthropic.com
  - stackoverflow.com
  - en.wikipedia.org
  - developer.mozilla.org

# Heartbeat schedules — proactive agent triggers.
# Each heartbeat creates a new session with the specified prompt.
# HITL approval still applies for any dangerous actions.
heartbeats:
  - name: morning-briefing
    schedule: "0 8 * * 1-5"        # 8am weekdays
    prompt: "Give me a brief morning summary: any important emails from overnight, calendar events for today, and any ongoing task updates."
    enabled: true

  - name: email-check
    schedule: "*/30 * * * *"        # Every 30 minutes
    prompt: "Check my email for anything urgent or time-sensitive. Only message me if there's something that needs attention."
    enabled: false                   # Disabled by default

# GitHub repos owned by the user (read_file_github auto-approves for these).
ownGitHubRepos: []
  # - yourusername/yourrepo

# OAuth service configurations (optional).
# Set client ID and secret for each service you want to connect.
# oauth:
#   google:
#     clientId: your-google-client-id
#     clientSecret: your-google-client-secret
#     callbackPort: 9876
#   github:
#     clientId: your-github-client-id
#     clientSecret: your-github-client-secret
#     callbackPort: 9876
